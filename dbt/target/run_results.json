{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.3", "generated_at": "2026-02-06T14:52:02.805295Z", "invocation_id": "c38e79f3-f39a-44ae-a019-a79096b289c1", "invocation_started_at": "2026-02-06T14:51:03.999704Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:07.199643Z", "completed_at": "2026-02-06T14:51:07.209493Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:07.209970Z", "completed_at": "2026-02-06T14:51:07.647884Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.45039820671081543, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-96ce-0015-32df000803f6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_home_health_care", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.HOME_HEALTH_CARE\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_home_health_care", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:07.203773Z", "completed_at": "2026-02-06T14:51:07.286914Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:07.289295Z", "completed_at": "2026-02-06T14:51:07.665847Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4674668312072754, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-96ce-0015-32df000803fa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_hospice", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.HOSPICE\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_hospice", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:07.650594Z", "completed_at": "2026-02-06T14:51:07.652408Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:07.652605Z", "completed_at": "2026-02-06T14:51:07.991117Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3410916328430176, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9809-0015-32df0008f08e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_medicare_hospital_spending", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.MEDICARE_HOSPITAL_SPENDING\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_medicare_hospital_spending", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:07.667835Z", "completed_at": "2026-02-06T14:51:07.669889Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:07.670099Z", "completed_at": "2026-02-06T14:51:08.145749Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.47839879989624023, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-94bb-0015-32df0007939e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_medicare_part_d_prescribers", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.MEDICARE_PART_D_PRESCRIBERS\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_medicare_part_d_prescribers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:07.993241Z", "completed_at": "2026-02-06T14:51:07.995902Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:07.996166Z", "completed_at": "2026-02-06T14:51:08.361069Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.36830687522888184, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9416-0015-32df00075416"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_nppes_provider", "compiled": true, "compiled_code": "with source as (\n    select * from AFFINE_NPPES_PROVIDER_DATA.REF_DW.DIM_PROVIDER\n    where IS_ACTIVE = true\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_nppes_provider", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:08.148010Z", "completed_at": "2026-02-06T14:51:08.152031Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:08.152271Z", "completed_at": "2026-02-06T14:51:08.489525Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.34209704399108887, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-981e-0015-32df0008b09e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_nppes_provider_address", "compiled": true, "compiled_code": "with source as (\n    select * from AFFINE_NPPES_PROVIDER_DATA.REF_DW.DIM_PROVIDER_ADDRESS\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_nppes_provider_address", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:07.207017Z", "completed_at": "2026-02-06T14:51:07.288962Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:07.291094Z", "completed_at": "2026-02-06T14:51:08.592106Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.393047571182251, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9809-0015-32df0008f092"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_longterm_care_hospital", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.LONGTERM_CARE_HOSPITAL\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_longterm_care_hospital", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:07.205551Z", "completed_at": "2026-02-06T14:51:07.286637Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:07.287301Z", "completed_at": "2026-02-06T14:51:08.596476Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.3976624011993408, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-94bb-0015-32df000793a2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_leie", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.LEIE\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_leie", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:08.363056Z", "completed_at": "2026-02-06T14:51:08.365044Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:08.365270Z", "completed_at": "2026-02-06T14:51:08.730554Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3681056499481201, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9370-0015-32df00071386"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_nppes_provider_taxonomy", "compiled": true, "compiled_code": "with source as (\n    select * from AFFINE_NPPES_PROVIDER_DATA.REF_DW.DIM_PROVIDER_TAXONOMY\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_nppes_provider_taxonomy", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:08.491475Z", "completed_at": "2026-02-06T14:51:08.493276Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:08.494054Z", "completed_at": "2026-02-06T14:51:08.877357Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3863999843597412, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9809-0015-32df0008f096"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_nppes_taxonomy_code", "compiled": true, "compiled_code": "with source as (\n    select * from AFFINE_NPPES_PROVIDER_DATA.REF_DW.REF_TAXONOMY_CODE\n    where IS_ACTIVE = true\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_nppes_taxonomy_code", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:08.603157Z", "completed_at": "2026-02-06T14:51:08.607881Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:08.608172Z", "completed_at": "2026-02-06T14:51:09.020270Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.419374942779541, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9673-0015-32df0007840a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_open_payments_ownership", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.OPEN_PAYMENTS_OWNERSHIP\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_open_payments_ownership", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:08.601289Z", "completed_at": "2026-02-06T14:51:08.605227Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:08.605463Z", "completed_at": "2026-02-06T14:51:09.031652Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.43146395683288574, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-94bb-0015-32df000793a6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_open_payments_general", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.OPEN_PAYMENTS_GENERAL\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_open_payments_general", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:08.879599Z", "completed_at": "2026-02-06T14:51:08.881585Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:08.881880Z", "completed_at": "2026-02-06T14:51:09.228059Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.34914112091064453, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9673-0015-32df0007840e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_provider_information", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.PROVIDER_INFORMATION\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_provider_information", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:08.737499Z", "completed_at": "2026-02-06T14:51:08.742605Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:08.742861Z", "completed_at": "2026-02-06T14:51:09.272128Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5362343788146973, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-96ce-0015-32df000803fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.stg_open_payments_research", "compiled": true, "compiled_code": "with source as (\n    select * from AI_FACTORY_DB.BRONZE.OPEN_PAYMENTS_RESEARCH\n)\n\nselect\n    *,\n    current_timestamp() as _loaded_at\nfrom source", "relation_name": "AI_FACTORY_DB.STAGING.stg_open_payments_research", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:09.032449Z", "completed_at": "2026-02-06T14:51:09.037212Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:09.037998Z", "completed_at": "2026-02-06T14:51:10.906110Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.8775231838226318, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-981e-0015-32df0008b0a2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.hospital_spending", "compiled": true, "compiled_code": "\n\n/*\n    Silver Hospital Spending\n    -------------------------\n    Cleaned Medicare hospital spending data with benchmarks.\n    Identifies hospitals with spending anomalies.\n*/\n\nwith spending as (\n    select * from AI_FACTORY_DB.STAGING.stg_medicare_hospital_spending\n),\n\ncleaned as (\n    select\n        -- Generate unique ID\n        md5(cast(coalesce(cast(FACILITY_ID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(CLAIM_TYPE as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PERIOD as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as SPENDING_ID,\n\n        -- Hospital identification\n        FACILITY_ID as CCN,\n        FACILITY_NAME as HOSPITAL_NAME,\n\n        -- Address\n        ADDRESS,\n        CITY,\n        STATE,\n        ZIP_CODE,\n        COUNTY_NAME as COUNTY,\n        PHONE_NUMBER as PHONE,\n\n        -- Spending category\n        CLAIM_TYPE,\n        PERIOD,\n\n        -- Spending amounts\n        try_to_number(AVG_SPENDING_PER_EPISODE_HOSPITAL, 18, 2) as AVG_SPENDING_HOSPITAL,\n        try_to_number(AVG_SPENDING_PER_EPISODE_STATE, 18, 2) as AVG_SPENDING_STATE,\n        try_to_number(AVG_SPENDING_PER_EPISODE_NATION, 18, 2) as AVG_SPENDING_NATION,\n\n        -- Spending percentages\n        try_to_number(PERCENT_OF_SPENDING_HOSPITAL, 18, 4) as PCT_SPENDING_HOSPITAL,\n        try_to_number(PERCENT_OF_SPENDING_STATE, 18, 4) as PCT_SPENDING_STATE,\n        try_to_number(PERCENT_OF_SPENDING_NATION, 18, 4) as PCT_SPENDING_NATION,\n\n        -- Dates\n        try_to_date(START_DATE, 'YYYY-MM-DD') as PERIOD_START_DATE,\n        try_to_date(END_DATE, 'YYYY-MM-DD') as PERIOD_END_DATE,\n\n        _LOAD_TIMESTAMP\n\n    from spending\n    where STATE is not null\n),\n\nwith_benchmarks as (\n    select\n        *,\n\n        -- Variance from benchmarks\n        case\n            when AVG_SPENDING_STATE > 0 then round((AVG_SPENDING_HOSPITAL - AVG_SPENDING_STATE) / AVG_SPENDING_STATE * 100, 2)\n            else null\n        end as PCT_VARIANCE_FROM_STATE,\n\n        case\n            when AVG_SPENDING_NATION > 0 then round((AVG_SPENDING_HOSPITAL - AVG_SPENDING_NATION) / AVG_SPENDING_NATION * 100, 2)\n            else null\n        end as PCT_VARIANCE_FROM_NATION,\n\n        -- Spending efficiency\n        case\n            when AVG_SPENDING_HOSPITAL < AVG_SPENDING_STATE then 'BELOW_STATE_AVG'\n            when AVG_SPENDING_HOSPITAL > AVG_SPENDING_STATE * 1.2 then 'ABOVE_STATE_AVG_20PCT'\n            else 'AT_STATE_AVG'\n        end as STATE_BENCHMARK_STATUS,\n\n        case\n            when AVG_SPENDING_HOSPITAL < AVG_SPENDING_NATION then 'BELOW_NATIONAL_AVG'\n            when AVG_SPENDING_HOSPITAL > AVG_SPENDING_NATION * 1.2 then 'ABOVE_NATIONAL_AVG_20PCT'\n            else 'AT_NATIONAL_AVG'\n        end as NATIONAL_BENCHMARK_STATUS\n\n    from cleaned\n),\n\nfinal as (\n    select\n        SPENDING_ID,\n\n        -- Hospital info\n        CCN,\n        HOSPITAL_NAME,\n        ADDRESS,\n        CITY,\n        STATE,\n        ZIP_CODE,\n        COUNTY,\n        PHONE,\n\n        -- Spending category\n        CLAIM_TYPE,\n        PERIOD,\n\n        -- Spending amounts\n        AVG_SPENDING_HOSPITAL,\n        AVG_SPENDING_STATE,\n        AVG_SPENDING_NATION,\n\n        -- Spending percentages\n        PCT_SPENDING_HOSPITAL,\n        PCT_SPENDING_STATE,\n        PCT_SPENDING_NATION,\n\n        -- Benchmarks\n        PCT_VARIANCE_FROM_STATE,\n        PCT_VARIANCE_FROM_NATION,\n        STATE_BENCHMARK_STATUS,\n        NATIONAL_BENCHMARK_STATUS,\n\n        -- Risk flags\n        case\n            when PCT_VARIANCE_FROM_NATION > 50 then true\n            else false\n        end as IS_HIGH_SPENDER,\n\n        case\n            when PCT_VARIANCE_FROM_NATION > 50 then 'HIGH'\n            when PCT_VARIANCE_FROM_NATION > 20 then 'MEDIUM'\n            when PCT_VARIANCE_FROM_NATION < -20 then 'LOW'\n            else 'NORMAL'\n        end as SPENDING_RISK_TIER,\n\n        -- Dates\n        PERIOD_START_DATE,\n        PERIOD_END_DATE,\n\n        -- Metadata\n        current_timestamp() as _loaded_at\n\n    from with_benchmarks\n)\n\nselect * from final", "relation_name": "AI_FACTORY_DB.SILVER.hospital_spending", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:09.049766Z", "completed_at": "2026-02-06T14:51:09.054640Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:09.055660Z", "completed_at": "2026-02-06T14:51:12.036562Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.99900221824646, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9370-0015-32df0007138a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.excluded_providers", "compiled": true, "compiled_code": "\n\n/*\n    Silver Excluded Providers (LEIE Enriched)\n    ------------------------------------------\n    Providers excluded from Medicare/Medicaid, enriched with NPPES data.\n    Critical table for fraud detection - any billing from these providers is suspicious.\n*/\n\nwith leie as (\n    select * from AI_FACTORY_DB.STAGING.stg_leie\n),\n\nnppes_provider as (\n    select * from AI_FACTORY_DB.STAGING.stg_nppes_provider\n),\n\nnppes_address as (\n    select * from AI_FACTORY_DB.STAGING.stg_nppes_provider_address\n    where IS_PRIMARY = true\n),\n\nleie_cleaned as (\n    select\n        -- Generate unique ID\n        md5(cast(coalesce(cast(NPI as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(EXCLDATE as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(LASTNAME as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FIRSTNAME as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as EXCLUSION_ID,\n\n        -- Provider identifiers\n        NPI,\n        UPIN,\n\n        -- Name fields\n        upper(trim(LASTNAME)) as LAST_NAME,\n        upper(trim(FIRSTNAME)) as FIRST_NAME,\n        upper(trim(MIDNAME)) as MIDDLE_NAME,\n        upper(trim(BUSNAME)) as BUSINESS_NAME,\n\n        -- Provider type\n        GENERAL as PROVIDER_GENERAL_TYPE,\n        SPECIALTY as PROVIDER_SPECIALTY,\n\n        -- Address from LEIE\n        upper(trim(ADDRESS)) as LEIE_ADDRESS,\n        upper(trim(CITY)) as LEIE_CITY,\n        upper(trim(STATE)) as LEIE_STATE,\n        trim(ZIP) as LEIE_ZIP,\n\n        -- Exclusion details\n        EXCLTYPE as EXCLUSION_TYPE_CODE,\n        case EXCLTYPE\n            when '1128a1' then 'Conviction of program-related crimes'\n            when '1128a2' then 'Conviction relating to patient abuse'\n            when '1128a3' then 'Felony conviction relating to health care fraud'\n            when '1128a4' then 'Felony conviction relating to controlled substance'\n            when '1128b1' then 'Misdemeanor conviction relating to health care fraud'\n            when '1128b2' then 'Conviction relating to obstruction of an investigation'\n            when '1128b4' then 'License revocation or suspension'\n            when '1128b5' then 'Exclusion or suspension under federal or state health care program'\n            when '1128b6' then 'Claims for excessive charges or unnecessary services'\n            when '1128b7' then 'Fraud, kickbacks and other prohibited activities'\n            when '1128b8' then 'Entities controlled by a sanctioned individual'\n            when '1128b14' then 'Default on health education loan or scholarship obligations'\n            when '1128b15' then 'Individuals controlling a sanctioned entity'\n            when '1128b16' then 'Making false statements or misrepresentation of material facts'\n            else 'Other exclusion type'\n        end as EXCLUSION_REASON,\n\n        -- Dates\n        try_to_date(EXCLDATE, 'YYYYMMDD') as EXCLUSION_DATE,\n        try_to_date(REINDATE, 'YYYYMMDD') as REINSTATEMENT_DATE,\n        try_to_date(WAIVERDATE, 'YYYYMMDD') as WAIVER_DATE,\n        try_to_date(DOB, 'YYYYMMDD') as DATE_OF_BIRTH,\n\n        -- Waiver info\n        WVRSTATE as WAIVER_STATE,\n\n        -- Status\n        case\n            when REINDATE is not null and REINDATE != '' then false\n            else true\n        end as IS_CURRENTLY_EXCLUDED,\n\n        _LOAD_TIMESTAMP\n\n    from leie\n    where EXCLDATE is not null and EXCLDATE != ''\n),\n\nenriched as (\n    select\n        l.*,\n\n        -- NPPES enrichment\n        n.ENTITY_TYPE_DESC as NPPES_ENTITY_TYPE,\n        n.PROVIDER_FULL_NAME as NPPES_FULL_NAME,\n        n.ORGANIZATION_NAME_LBN as NPPES_ORGANIZATION,\n        n.PRIMARY_TAXONOMY_CODE as NPPES_TAXONOMY_CODE,\n        n.IS_ACTIVE as NPPES_IS_ACTIVE,\n        n.ENUMERATION_DATE as NPPES_ENUMERATION_DATE,\n\n        -- NPPES Address\n        a.CITY_NAME as NPPES_CITY,\n        a.STATE_CODE as NPPES_STATE,\n        a.POSTAL_CODE_5 as NPPES_ZIP,\n\n        -- Match quality\n        case\n            when l.NPI is not null and n.NPI is not null then 'NPI_MATCH'\n            when l.NPI is null then 'NO_NPI_IN_LEIE'\n            else 'NPI_NOT_FOUND_IN_NPPES'\n        end as MATCH_STATUS\n\n    from leie_cleaned l\n    left join nppes_provider n on l.NPI = n.NPI\n    left join nppes_address a on l.NPI = a.NPI\n),\n\nfinal as (\n    select\n        EXCLUSION_ID,\n        NPI,\n        UPIN,\n\n        -- Names\n        LAST_NAME,\n        FIRST_NAME,\n        MIDDLE_NAME,\n        BUSINESS_NAME,\n        NPPES_FULL_NAME,\n        NPPES_ORGANIZATION,\n\n        -- Provider info\n        PROVIDER_GENERAL_TYPE,\n        PROVIDER_SPECIALTY,\n        NPPES_ENTITY_TYPE,\n        NPPES_TAXONOMY_CODE,\n\n        -- LEIE Address\n        LEIE_ADDRESS as ADDRESS,\n        LEIE_CITY as CITY,\n        LEIE_STATE as STATE,\n        LEIE_ZIP as ZIP_CODE,\n\n        -- NPPES Address (for comparison)\n        NPPES_CITY,\n        NPPES_STATE,\n        NPPES_ZIP,\n\n        -- Exclusion details\n        EXCLUSION_TYPE_CODE,\n        EXCLUSION_REASON,\n        EXCLUSION_DATE,\n        REINSTATEMENT_DATE,\n        WAIVER_DATE,\n        WAIVER_STATE,\n        DATE_OF_BIRTH,\n\n        -- Status flags\n        IS_CURRENTLY_EXCLUDED,\n        NPPES_IS_ACTIVE,\n\n        -- Fraud risk: excluded but still active in NPPES\n        case\n            when IS_CURRENTLY_EXCLUDED = true and NPPES_IS_ACTIVE = true then true\n            else false\n        end as IS_HIGH_RISK,\n\n        -- Match quality\n        MATCH_STATUS,\n\n        -- Metadata\n        current_timestamp() as _loaded_at\n\n    from enriched\n)\n\nselect * from final", "relation_name": "AI_FACTORY_DB.SILVER.excluded_providers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:10.908834Z", "completed_at": "2026-02-06T14:51:10.914017Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:10.914240Z", "completed_at": "2026-02-06T14:51:12.650483Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7423532009124756, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-981e-0015-32df0008b0a6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.facilities", "compiled": true, "compiled_code": "\n\n/*\n    Silver Facilities (Unified Healthcare Facilities)\n    ---------------------------------------------------\n    Consolidates Hospice, Home Health Care, Long-Term Care Hospitals,\n    and Nursing Home (Provider Information) into a single facilities table.\n*/\n\nwith hospice as (\n    select\n        'HOSPICE' as FACILITY_TYPE,\n        CMS_CERTIFICATION_NUMBER as CCN,\n        FACILITY_NAME as NAME,\n        ADDRESS_LINE_1 as ADDRESS_LINE_1,\n        ADDRESS_LINE_2 as ADDRESS_LINE_2,\n        CITY,\n        STATE,\n        ZIP_CODE,\n        COUNTY_NAME as COUNTY,\n        PHONE_NUMBER as PHONE,\n        CMS_REGION,\n        OWNERSHIP_TYPE,\n        try_to_date(CERTIFICATION_DATE, 'YYYY-MM-DD') as CERTIFICATION_DATE,\n        null as OVERALL_RATING,\n        null as HEALTH_INSPECTION_RATING,\n        null as STAFFING_RATING,\n        null as NUMBER_OF_BEDS,\n        null as NUMBER_OF_RESIDENTS,\n        _LOAD_TIMESTAMP\n    from AI_FACTORY_DB.STAGING.stg_hospice\n    where CMS_CERTIFICATION_NUMBER is not null\n),\n\nhome_health as (\n    select\n        'HOME_HEALTH' as FACILITY_TYPE,\n        CMS_CERTIFICATION_NUMBER as CCN,\n        PROVIDER_NAME as NAME,\n        ADDRESS as ADDRESS_LINE_1,\n        null as ADDRESS_LINE_2,\n        CITY,\n        STATE,\n        ZIP_CODE,\n        null as COUNTY,\n        PHONE,\n        null as CMS_REGION,\n        TYPE_OF_OWNERSHIP as OWNERSHIP_TYPE,\n        try_to_date(DATE_CERTIFIED, 'YYYY-MM-DD') as CERTIFICATION_DATE,\n        null as OVERALL_RATING,\n        null as HEALTH_INSPECTION_RATING,\n        null as STAFFING_RATING,\n        null as NUMBER_OF_BEDS,\n        null as NUMBER_OF_RESIDENTS,\n        _LOAD_TIMESTAMP\n    from AI_FACTORY_DB.STAGING.stg_home_health_care\n    where CMS_CERTIFICATION_NUMBER is not null\n),\n\nltch as (\n    select\n        'LTCH' as FACILITY_TYPE,\n        CMS_CERTIFICATION_NUMBER as CCN,\n        FACILITY_NAME as NAME,\n        ADDRESS as ADDRESS_LINE_1,\n        null as ADDRESS_LINE_2,\n        CITY,\n        STATE,\n        ZIP_CODE,\n        COUNTY_NAME as COUNTY,\n        PHONE_NUMBER as PHONE,\n        CMS_REGION,\n        null as OWNERSHIP_TYPE,\n        null as CERTIFICATION_DATE,\n        null as OVERALL_RATING,\n        null as HEALTH_INSPECTION_RATING,\n        null as STAFFING_RATING,\n        null as NUMBER_OF_BEDS,\n        null as NUMBER_OF_RESIDENTS,\n        _LOAD_TIMESTAMP\n    from AI_FACTORY_DB.STAGING.stg_longterm_care_hospital\n    where CMS_CERTIFICATION_NUMBER is not null\n),\n\nnursing_home as (\n    select\n        'NURSING_HOME' as FACILITY_TYPE,\n        FEDERAL_PROVIDER_NUMBER as CCN,\n        PROVIDER_NAME as NAME,\n        PROVIDER_ADDRESS as ADDRESS_LINE_1,\n        null as ADDRESS_LINE_2,\n        PROVIDER_CITY as CITY,\n        PROVIDER_STATE as STATE,\n        PROVIDER_ZIP_CODE as ZIP_CODE,\n        PROVIDER_COUNTY_NAME as COUNTY,\n        PROVIDER_PHONE_NUMBER as PHONE,\n        null as CMS_REGION,\n        OWNERSHIP_TYPE,\n        try_to_date(DATE_FIRST_APPROVED, 'YYYY-MM-DD') as CERTIFICATION_DATE,\n        try_to_number(OVERALL_RATING) as OVERALL_RATING,\n        try_to_number(HEALTH_INSPECTION_RATING) as HEALTH_INSPECTION_RATING,\n        try_to_number(STAFFING_RATING) as STAFFING_RATING,\n        try_to_number(NUMBER_OF_CERTIFIED_BEDS) as NUMBER_OF_BEDS,\n        try_to_number(NUMBER_OF_RESIDENTS) as NUMBER_OF_RESIDENTS,\n        _LOAD_TIMESTAMP\n    from AI_FACTORY_DB.STAGING.stg_provider_information\n    where FEDERAL_PROVIDER_NUMBER is not null\n),\n\nall_facilities as (\n    select * from hospice\n    union all\n    select * from home_health\n    union all\n    select * from ltch\n    union all\n    select * from nursing_home\n),\n\ndeduplicated as (\n    select\n        *,\n        row_number() over (\n            partition by CCN\n            order by _LOAD_TIMESTAMP desc\n        ) as rn\n    from all_facilities\n),\n\nfinal as (\n    select\n        -- Generate unique facility ID\n        md5(cast(coalesce(cast(FACILITY_TYPE as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(CCN as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as FACILITY_ID,\n\n        -- Facility identification\n        CCN,\n        NAME as FACILITY_NAME,\n        FACILITY_TYPE,\n\n        -- Address\n        ADDRESS_LINE_1,\n        ADDRESS_LINE_2,\n        CITY,\n        STATE,\n        ZIP_CODE,\n        COUNTY,\n        concat_ws(', ', ADDRESS_LINE_1, CITY, STATE, ZIP_CODE) as FULL_ADDRESS,\n\n        -- Contact\n        PHONE,\n        CMS_REGION,\n\n        -- Organization\n        OWNERSHIP_TYPE,\n        case\n            when OWNERSHIP_TYPE ilike '%profit%' and OWNERSHIP_TYPE not ilike '%non%' then 'FOR_PROFIT'\n            when OWNERSHIP_TYPE ilike '%non%profit%' or OWNERSHIP_TYPE ilike '%not%profit%' then 'NON_PROFIT'\n            when OWNERSHIP_TYPE ilike '%government%' or OWNERSHIP_TYPE ilike '%state%' or OWNERSHIP_TYPE ilike '%county%' then 'GOVERNMENT'\n            else 'OTHER'\n        end as OWNERSHIP_CATEGORY,\n\n        -- Dates\n        CERTIFICATION_DATE,\n\n        -- Quality metrics (nursing homes only)\n        OVERALL_RATING,\n        HEALTH_INSPECTION_RATING,\n        STAFFING_RATING,\n\n        -- Capacity (nursing homes only)\n        NUMBER_OF_BEDS,\n        NUMBER_OF_RESIDENTS,\n        case\n            when NUMBER_OF_BEDS > 0 then round(NUMBER_OF_RESIDENTS / NUMBER_OF_BEDS * 100, 1)\n            else null\n        end as OCCUPANCY_RATE,\n\n        -- Risk indicators\n        case\n            when OVERALL_RATING = 1 then true\n            else false\n        end as IS_LOW_QUALITY,\n\n        -- Metadata\n        current_timestamp() as _loaded_at\n\n    from deduplicated\n    where rn = 1\n)\n\nselect * from final", "relation_name": "AI_FACTORY_DB.SILVER.facilities", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:09.231250Z", "completed_at": "2026-02-06T14:51:09.234391Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:09.234591Z", "completed_at": "2026-02-06T14:51:19.104173Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 9.873607873916626, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9865-0015-32df0009105e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.prescriptions", "compiled": true, "compiled_code": "\n\n/*\n    Silver Prescriptions (Medicare Part D Cleaned)\n    -----------------------------------------------\n    Cleaned and enriched prescription data for fraud pattern detection.\n    Key metrics: prescribing volume, cost per prescription, outlier detection.\n*/\n\nwith prescriptions as (\n    select * from AI_FACTORY_DB.STAGING.stg_medicare_part_d_prescribers\n),\n\nexcluded_npis as (\n    select distinct NPI\n    from AI_FACTORY_DB.STAGING.stg_leie\n    where NPI is not null and NPI != ''\n),\n\ncleaned as (\n    select\n        -- Generate unique ID\n        md5(cast(coalesce(cast(PRSCRBR_NPI as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(BRND_NAME as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(GNRC_NAME as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as PRESCRIPTION_ID,\n\n        -- Prescriber info\n        PRSCRBR_NPI as NPI,\n        PRSCRBR_LAST_ORG_NAME as PRESCRIBER_LAST_NAME,\n        PRSCRBR_FIRST_NAME as PRESCRIBER_FIRST_NAME,\n        concat_ws(' ', PRSCRBR_FIRST_NAME, PRSCRBR_LAST_ORG_NAME) as PRESCRIBER_FULL_NAME,\n        PRSCRBR_CITY as CITY,\n        PRSCRBR_STATE_ABRVTN as STATE,\n        PRSCRBR_TYPE as PRESCRIBER_TYPE,\n\n        -- Drug info\n        BRND_NAME as BRAND_NAME,\n        GNRC_NAME as GENERIC_NAME,\n        case\n            when BRND_NAME is not null and BRND_NAME != GNRC_NAME then 'BRAND'\n            else 'GENERIC'\n        end as DRUG_TYPE,\n\n        -- Volume metrics (all beneficiaries)\n        try_to_number(TOT_CLMS) as TOTAL_CLAIMS,\n        try_to_number(TOT_30DAY_FILLS, 18, 2) as TOTAL_30DAY_FILLS,\n        try_to_number(TOT_DAY_SUPLY) as TOTAL_DAYS_SUPPLY,\n        try_to_number(TOT_DRUG_CST, 18, 2) as TOTAL_DRUG_COST,\n        try_to_number(TOT_BENES) as TOTAL_BENEFICIARIES,\n\n        -- Volume metrics (65+ beneficiaries)\n        try_to_number(GE65_TOT_CLMS) as TOTAL_CLAIMS_65PLUS,\n        try_to_number(GE65_TOT_30DAY_FILLS, 18, 2) as TOTAL_30DAY_FILLS_65PLUS,\n        try_to_number(GE65_TOT_DAY_SUPLY) as TOTAL_DAYS_SUPPLY_65PLUS,\n        try_to_number(GE65_TOT_DRUG_CST, 18, 2) as TOTAL_DRUG_COST_65PLUS,\n        try_to_number(GE65_TOT_BENES) as TOTAL_BENEFICIARIES_65PLUS,\n\n        -- Suppression flags\n        GE65_SPRSN_FLAG as SUPPRESSION_FLAG_65PLUS,\n        GE65_BENE_SPRSN_FLAG as BENE_SUPPRESSION_FLAG_65PLUS,\n\n        _LOAD_TIMESTAMP\n\n    from prescriptions\n    where PRSCRBR_NPI is not null and PRSCRBR_NPI != ''\n),\n\nwith_metrics as (\n    select\n        *,\n\n        -- Calculated metrics\n        case\n            when TOTAL_CLAIMS > 0 then round(TOTAL_DRUG_COST / TOTAL_CLAIMS, 2)\n            else 0\n        end as AVG_COST_PER_CLAIM,\n\n        case\n            when TOTAL_BENEFICIARIES > 0 then round(TOTAL_DRUG_COST / TOTAL_BENEFICIARIES, 2)\n            else 0\n        end as AVG_COST_PER_BENEFICIARY,\n\n        case\n            when TOTAL_BENEFICIARIES > 0 then round(TOTAL_CLAIMS / TOTAL_BENEFICIARIES, 2)\n            else 0\n        end as AVG_CLAIMS_PER_BENEFICIARY,\n\n        case\n            when TOTAL_30DAY_FILLS > 0 then round(TOTAL_DAYS_SUPPLY / TOTAL_30DAY_FILLS, 2)\n            else 0\n        end as AVG_DAYS_PER_FILL\n\n    from cleaned\n),\n\nfinal as (\n    select\n        m.PRESCRIPTION_ID,\n\n        -- Prescriber\n        m.NPI,\n        m.PRESCRIBER_LAST_NAME,\n        m.PRESCRIBER_FIRST_NAME,\n        m.PRESCRIBER_FULL_NAME,\n        m.CITY,\n        m.STATE,\n        m.PRESCRIBER_TYPE,\n\n        -- Drug\n        m.BRAND_NAME,\n        m.GENERIC_NAME,\n        m.DRUG_TYPE,\n\n        -- Volume - All\n        m.TOTAL_CLAIMS,\n        m.TOTAL_30DAY_FILLS,\n        m.TOTAL_DAYS_SUPPLY,\n        m.TOTAL_DRUG_COST,\n        m.TOTAL_BENEFICIARIES,\n\n        -- Volume - 65+\n        m.TOTAL_CLAIMS_65PLUS,\n        m.TOTAL_30DAY_FILLS_65PLUS,\n        m.TOTAL_DAYS_SUPPLY_65PLUS,\n        m.TOTAL_DRUG_COST_65PLUS,\n        m.TOTAL_BENEFICIARIES_65PLUS,\n\n        -- Calculated metrics\n        m.AVG_COST_PER_CLAIM,\n        m.AVG_COST_PER_BENEFICIARY,\n        m.AVG_CLAIMS_PER_BENEFICIARY,\n        m.AVG_DAYS_PER_FILL,\n\n        -- Fraud detection flags\n        case when e.NPI is not null then true else false end as IS_PRESCRIBER_EXCLUDED,\n\n        -- High volume flags (potential fraud indicators)\n        case when m.TOTAL_CLAIMS > 1000 then true else false end as IS_HIGH_VOLUME_PRESCRIBER,\n        case when m.AVG_COST_PER_CLAIM > 500 then true else false end as IS_HIGH_COST_PRESCRIBER,\n        case when m.AVG_CLAIMS_PER_BENEFICIARY > 10 then true else false end as IS_HIGH_CLAIMS_PER_BENE,\n\n        -- Risk tier\n        case\n            when e.NPI is not null then 'CRITICAL'\n            when m.TOTAL_DRUG_COST > 1000000 then 'VERY_HIGH'\n            when m.TOTAL_DRUG_COST > 100000 then 'HIGH'\n            when m.TOTAL_DRUG_COST > 10000 then 'MEDIUM'\n            else 'LOW'\n        end as RISK_TIER,\n\n        -- Metadata\n        current_timestamp() as _loaded_at\n\n    from with_metrics m\n    left join excluded_npis e on m.NPI = e.NPI\n)\n\nselect * from final", "relation_name": "AI_FACTORY_DB.SILVER.prescriptions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:12.043378Z", "completed_at": "2026-02-06T14:51:12.051307Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:12.051602Z", "completed_at": "2026-02-06T14:51:51.152852Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 39.1109561920166, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9370-0015-32df0007138e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.payments", "compiled": true, "compiled_code": "\n\n/*\n    Silver Payments (Open Payments Consolidated)\n    ---------------------------------------------\n    Consolidates General, Research, and Ownership payments into a single table.\n    Key table for detecting pharmaceutical influence patterns.\n\n    Note: Open Payments columns are case-sensitive (created via INFER_SCHEMA)\n*/\n\nwith general_payments as (\n    select\n        'GENERAL' as PAYMENT_CATEGORY,\n        \"Record_ID\" as RECORD_ID,\n        \"Covered_Recipient_NPI\" as NPI,\n        \"Covered_Recipient_Type\" as RECIPIENT_TYPE,\n        \"Covered_Recipient_First_Name\" as FIRST_NAME,\n        \"Covered_Recipient_Last_Name\" as LAST_NAME,\n        \"Covered_Recipient_Specialty_1\" as SPECIALTY,\n        \"Recipient_City\" as CITY,\n        \"Recipient_State\" as STATE,\n        \"Recipient_Zip_Code\" as ZIP_CODE,\n        \"Teaching_Hospital_Name\" as TEACHING_HOSPITAL,\n        \"Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Name\" as PAYER_NAME,\n        try_to_number(\"Total_Amount_of_Payment_USDollars\", 18, 2) as PAYMENT_AMOUNT,\n        try_to_date(\"Date_of_Payment\", 'MM/DD/YYYY') as PAYMENT_DATE,\n        \"Form_of_Payment_or_Transfer_of_Value\" as PAYMENT_FORM,\n        \"Nature_of_Payment_or_Transfer_of_Value\" as PAYMENT_NATURE,\n        \"Program_Year\" as PROGRAM_YEAR,\n        null as STUDY_NAME,\n        null as CLINICAL_TRIAL_ID,\n        null as INVESTMENT_AMOUNT,\n        null as INTEREST_VALUE\n    from AI_FACTORY_DB.STAGING.stg_open_payments_general\n    where \"Record_ID\" is not null\n),\n\nresearch_payments as (\n    select\n        'RESEARCH' as PAYMENT_CATEGORY,\n        \"Record_ID\" as RECORD_ID,\n        \"Covered_Recipient_NPI\" as NPI,\n        \"Covered_Recipient_Type\" as RECIPIENT_TYPE,\n        \"Covered_Recipient_First_Name\" as FIRST_NAME,\n        \"Covered_Recipient_Last_Name\" as LAST_NAME,\n        \"Covered_Recipient_Specialty_1\" as SPECIALTY,\n        \"Recipient_City\" as CITY,\n        \"Recipient_State\" as STATE,\n        \"Recipient_Zip_Code\" as ZIP_CODE,\n        \"Teaching_Hospital_Name\" as TEACHING_HOSPITAL,\n        \"Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Name\" as PAYER_NAME,\n        try_to_number(\"Total_Amount_of_Payment_USDollars\", 18, 2) as PAYMENT_AMOUNT,\n        try_to_date(\"Date_of_Payment\", 'MM/DD/YYYY') as PAYMENT_DATE,\n        \"Form_of_Payment_or_Transfer_of_Value\" as PAYMENT_FORM,\n        null as PAYMENT_NATURE,\n        \"Program_Year\" as PROGRAM_YEAR,\n        \"Name_of_Study\" as STUDY_NAME,\n        \"ClinicalTrials_Gov_Identifier\" as CLINICAL_TRIAL_ID,\n        null as INVESTMENT_AMOUNT,\n        null as INTEREST_VALUE\n    from AI_FACTORY_DB.STAGING.stg_open_payments_research\n    where \"Record_ID\" is not null\n),\n\nownership_payments as (\n    select\n        'OWNERSHIP' as PAYMENT_CATEGORY,\n        \"Record_ID\" as RECORD_ID,\n        \"Physician_NPI\" as NPI,\n        'Physician' as RECIPIENT_TYPE,\n        \"Physician_First_Name\" as FIRST_NAME,\n        \"Physician_Last_Name\" as LAST_NAME,\n        \"Physician_Specialty\" as SPECIALTY,\n        \"Recipient_City\" as CITY,\n        \"Recipient_State\" as STATE,\n        \"Recipient_Zip_Code\" as ZIP_CODE,\n        null as TEACHING_HOSPITAL,\n        \"Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Name\" as PAYER_NAME,\n        null as PAYMENT_AMOUNT,\n        null as PAYMENT_DATE,\n        null as PAYMENT_FORM,\n        null as PAYMENT_NATURE,\n        \"Program_Year\" as PROGRAM_YEAR,\n        null as STUDY_NAME,\n        null as CLINICAL_TRIAL_ID,\n        try_to_number(\"Total_Amount_Invested_USDollars\", 18, 2) as INVESTMENT_AMOUNT,\n        \"Value_of_Interest\" as INTEREST_VALUE\n    from AI_FACTORY_DB.STAGING.stg_open_payments_ownership\n    where \"Record_ID\" is not null\n),\n\nall_payments as (\n    select * from general_payments\n    union all\n    select * from research_payments\n    union all\n    select * from ownership_payments\n),\n\nexcluded_npis as (\n    select distinct NPI\n    from AI_FACTORY_DB.STAGING.stg_leie\n    where NPI is not null and NPI != ''\n),\n\nfinal as (\n    select\n        -- Generate unique payment ID\n        md5(cast(coalesce(cast(PAYMENT_CATEGORY as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(RECORD_ID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as PAYMENT_ID,\n\n        -- Payment classification\n        p.PAYMENT_CATEGORY,\n        p.RECORD_ID,\n\n        -- Recipient info\n        p.NPI,\n        p.RECIPIENT_TYPE,\n        p.FIRST_NAME,\n        p.LAST_NAME,\n        concat_ws(' ', p.FIRST_NAME, p.LAST_NAME) as FULL_NAME,\n        p.SPECIALTY,\n\n        -- Location\n        p.CITY,\n        p.STATE,\n        p.ZIP_CODE,\n        p.TEACHING_HOSPITAL,\n\n        -- Payer info\n        p.PAYER_NAME,\n\n        -- Payment details\n        p.PAYMENT_AMOUNT,\n        p.PAYMENT_DATE,\n        p.PAYMENT_FORM,\n        p.PAYMENT_NATURE,\n        extract(year from p.PAYMENT_DATE) as PAYMENT_YEAR,\n        extract(month from p.PAYMENT_DATE) as PAYMENT_MONTH,\n\n        -- Research specific\n        p.STUDY_NAME,\n        p.CLINICAL_TRIAL_ID,\n\n        -- Ownership specific\n        p.INVESTMENT_AMOUNT,\n        p.INTEREST_VALUE,\n\n        -- Program info\n        try_to_number(p.PROGRAM_YEAR) as PROGRAM_YEAR,\n\n        -- Fraud detection flags\n        case when e.NPI is not null then true else false end as IS_RECIPIENT_EXCLUDED,\n\n        -- Payment risk tiers\n        case\n            when p.PAYMENT_AMOUNT >= 100000 then 'VERY_HIGH'\n            when p.PAYMENT_AMOUNT >= 10000 then 'HIGH'\n            when p.PAYMENT_AMOUNT >= 1000 then 'MEDIUM'\n            when p.PAYMENT_AMOUNT >= 100 then 'LOW'\n            else 'MINIMAL'\n        end as PAYMENT_RISK_TIER,\n\n        -- Metadata\n        current_timestamp() as _loaded_at\n\n    from all_payments p\n    left join excluded_npis e on p.NPI = e.NPI\n)\n\nselect * from final", "relation_name": "AI_FACTORY_DB.SILVER.payments", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T14:51:09.274205Z", "completed_at": "2026-02-06T14:51:09.276592Z"}, {"name": "execute", "started_at": "2026-02-06T14:51:09.276791Z", "completed_at": "2026-02-06T14:52:01.742597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 52.46896815299988, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c23bbb-0000-9416-0015-32df0007541a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.ai_factory.provider", "compiled": true, "compiled_code": "\n\n/*\n    Silver Provider Master\n    -----------------------\n    Combines NPPES provider data with address and taxonomy information.\n    This is the main provider reference table for fraud detection.\n*/\n\nwith nppes_provider as (\n    select * from AI_FACTORY_DB.STAGING.stg_nppes_provider\n),\n\nnppes_address as (\n    select * from AI_FACTORY_DB.STAGING.stg_nppes_provider_address\n    where IS_PRIMARY = true\n),\n\nnppes_taxonomy as (\n    select * from AI_FACTORY_DB.STAGING.stg_nppes_provider_taxonomy\n    where IS_PRIMARY_TAXONOMY = true\n),\n\nexcluded_providers as (\n    select distinct NPI\n    from AI_FACTORY_DB.STAGING.stg_leie\n    where NPI is not null and NPI != ''\n),\n\nprovider_with_address as (\n    select\n        p.NPI,\n        p.ENTITY_TYPE_CODE,\n        p.ENTITY_TYPE_DESC,\n        p.ORGANIZATION_NAME_LBN,\n        p.PROVIDER_LAST_NAME,\n        p.PROVIDER_FIRST_NAME,\n        p.PROVIDER_MIDDLE_NAME,\n        p.PROVIDER_FULL_NAME,\n        p.PROVIDER_CREDENTIAL,\n        p.PROVIDER_SEX_CODE,\n        p.PROVIDER_SEX_DESC,\n        p.IS_SOLE_PROPRIETOR,\n        p.PARENT_ORGANIZATION_LBN,\n        p.EIN,\n        p.PRIMARY_TAXONOMY_CODE,\n        p.ENUMERATION_DATE,\n        p.LAST_UPDATE_DATE,\n        p.IS_ACTIVE as IS_NPI_ACTIVE,\n\n        -- Address fields\n        a.ADDRESS_LINE_1,\n        a.ADDRESS_LINE_2,\n        a.CITY_NAME,\n        a.STATE_CODE,\n        a.POSTAL_CODE_5 as ZIP_CODE,\n        a.TELEPHONE_NUMBER,\n        a.FULL_ADDRESS\n\n    from nppes_provider p\n    left join nppes_address a on p.NPI = a.NPI\n),\n\nprovider_with_taxonomy as (\n    select\n        p.*,\n\n        -- Taxonomy fields\n        t.TAXONOMY_CODE,\n        t.TAXONOMY_CLASSIFICATION,\n        t.TAXONOMY_SPECIALIZATION,\n        t.PROVIDER_TYPE\n\n    from provider_with_address p\n    left join nppes_taxonomy t on p.NPI = t.NPI\n),\n\nfinal as (\n    select\n        -- Primary key\n        p.NPI,\n\n        -- Provider identification\n        p.ENTITY_TYPE_CODE,\n        p.ENTITY_TYPE_DESC,\n        case\n            when p.ENTITY_TYPE_CODE = '1' then 'Individual'\n            when p.ENTITY_TYPE_CODE = '2' then 'Organization'\n            else 'Unknown'\n        end as ENTITY_TYPE,\n\n        -- Name fields\n        p.ORGANIZATION_NAME_LBN as ORGANIZATION_NAME,\n        p.PROVIDER_LAST_NAME as LAST_NAME,\n        p.PROVIDER_FIRST_NAME as FIRST_NAME,\n        p.PROVIDER_MIDDLE_NAME as MIDDLE_NAME,\n        p.PROVIDER_FULL_NAME as FULL_NAME,\n        p.PROVIDER_CREDENTIAL as CREDENTIAL,\n\n        -- Demographics\n        p.PROVIDER_SEX_CODE as GENDER_CODE,\n        p.PROVIDER_SEX_DESC as GENDER,\n\n        -- Organization info\n        p.IS_SOLE_PROPRIETOR,\n        p.PARENT_ORGANIZATION_LBN as PARENT_ORGANIZATION,\n        p.EIN,\n\n        -- Address\n        p.ADDRESS_LINE_1,\n        p.ADDRESS_LINE_2,\n        p.CITY_NAME as CITY,\n        p.STATE_CODE as STATE,\n        p.ZIP_CODE,\n        p.TELEPHONE_NUMBER as PHONE,\n        p.FULL_ADDRESS,\n\n        -- Taxonomy/Specialty\n        p.PRIMARY_TAXONOMY_CODE,\n        p.TAXONOMY_CODE,\n        p.TAXONOMY_CLASSIFICATION as SPECIALTY_CLASSIFICATION,\n        p.TAXONOMY_SPECIALIZATION as SPECIALTY,\n        p.PROVIDER_TYPE,\n\n        -- Dates\n        p.ENUMERATION_DATE as NPI_ENUMERATION_DATE,\n        p.LAST_UPDATE_DATE as NPI_LAST_UPDATE_DATE,\n\n        -- Status flags\n        p.IS_NPI_ACTIVE,\n        case when e.NPI is not null then true else false end as IS_EXCLUDED,\n\n        -- Metadata\n        current_timestamp() as _loaded_at\n\n    from provider_with_taxonomy p\n    left join excluded_providers e on p.NPI = e.NPI\n)\n\nselect * from final", "relation_name": "AI_FACTORY_DB.SILVER.provider", "batch_results": null}], "elapsed_time": 57.69151711463928, "args": {"defer": false, "require_resource_names_without_spaces": true, "static_parser": true, "which": "run", "quiet": false, "log_file_max_bytes": 10485760, "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "cache_selected_only": false, "source_freshness_run_project_hooks": true, "macro_debugging": false, "profiles_dir": ".", "project_dir": "/opt/airflow/dbt", "log_format_file": "debug", "strict_mode": false, "log_path": "/opt/airflow/dbt/logs", "introspect": true, "use_colors": true, "vars": {}, "empty": false, "print": true, "show_all_deprecations": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_nested_cumulative_type_params": false, "full_refresh": true, "validate_macro_args": false, "write_json": true, "require_all_warnings_handled_by_warn_error": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_yaml_configuration_for_mf_time_spines": false, "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "log_level_file": "debug", "exclude": [], "send_anonymous_usage_stats": true, "select": [], "printer_width": 80, "invocation_command": "dbt run --profiles-dir . --full-refresh", "require_ref_searches_node_package_before_root": false, "populate_cache": true, "require_unique_project_resource_names": false, "upload_to_artifacts_ingest_api": false, "partial_parse_file_diff": true, "state_modified_compare_vars": false, "version_check": true, "log_format": "default", "use_fast_test_edges": false, "partial_parse": true, "require_generic_test_arguments_property": true, "use_colors_file": true, "favor_state": false}}